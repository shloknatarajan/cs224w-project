2025-12-08 01:03:37,326 - Using device: cuda
2025-12-08 01:03:37,326 - Logging results to: logs/diagnostic_test_20251208_010337.log
2025-12-08 01:03:37,326 - Loading dataset...
2025-12-08 01:03:37,326 - Loading dataset ogbl-ddi...
2025-12-08 01:03:37,414 - Dataset loaded: 4267 nodes
2025-12-08 01:03:37,566 - Train pos edges: 1067911, Valid pos: 133489, Test pos: 133489
2025-12-08 01:03:37,566 - Valid neg edges: 101882, Test neg: 95599
2025-12-08 01:03:37,586 - Added self-loops: Total edges now = 1072178
2025-12-08 01:03:37,593 - 
================================================================================
2025-12-08 01:03:37,593 - Testing Diagnostic System with GCN
2025-12-08 01:03:37,593 - ================================================================================
2025-12-08 01:03:37,634 - Starting training for GCN-DiagTest (epochs=15, lr=0.01, patience=20, hard_neg=False)
2025-12-08 01:03:37,635 - Model description: Graph Convolutional Network with spectral convolutions | hidden_dim=128, num_layers=2, dropout=0.5, decoder_dropout=0.3, decoder=simple
2025-12-08 01:03:37,635 - Memory optimization: batch_size=50000, gradient_accumulation=1
2025-12-08 01:03:37,636 - Initialized EMA with decay=0.999 for stable checkpointing
2025-12-08 01:03:39,753 - GCN-DiagTest Epoch 0001/15 [Random Neg] | Loss: 1.4659 | Val Hits@20: 0.0003 | Test Hits@20: 0.0004 | Best Val: 0.0003 (epoch 1) | LR: 0.010000 üî•
2025-12-08 01:03:40,224 - [DIAGNOSTICS Epoch 1] Emb: sim_mean=0.969 sim_std=0.030 norm=0.209 | Scores: pos=0.503 neg=0.503 gap=0.000 | Grad: norm=0.00
2025-12-08 01:03:40,224 -   ‚ö†Ô∏è  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 01:03:40,224 -   ‚ö†Ô∏è  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 01:03:47,021 - GCN-DiagTest Epoch 0005/15 [Random Neg] | Loss: 1.3170 | Val Hits@20: 0.0007 | Test Hits@20: 0.0008 | Best Val: 0.0007 (epoch 5) | LR: 0.010000 üî•
2025-12-08 01:03:47,477 - [DIAGNOSTICS Epoch 5] Emb: sim_mean=0.970 sim_std=0.075 norm=4.344 | Scores: pos=0.892 neg=0.683 gap=0.209 | Grad: norm=0.00
2025-12-08 01:03:47,478 -   ‚ö†Ô∏è  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 01:03:47,478 -   ‚ö†Ô∏è  GRADIENT VANISHING
2025-12-08 01:03:55,776 - GCN-DiagTest Epoch 0010/15 [Random Neg] | Loss: 1.3365 | Val Hits@20: 0.0010 | Test Hits@20: 0.0016 | Best Val: 0.0010 (epoch 10) | LR: 0.010000 üî•
2025-12-08 01:03:56,272 - [DIAGNOSTICS Epoch 10] Emb: sim_mean=0.705 sim_std=0.361 norm=1.643 | Scores: pos=0.533 neg=0.457 gap=0.076 | Grad: norm=0.00
2025-12-08 01:03:56,272 -   ‚ö†Ô∏è  GRADIENT VANISHING
2025-12-08 01:04:04,616 - GCN-DiagTest Epoch 0015/15 [Random Neg] | Loss: 1.1760 | Val Hits@20: 0.0014 | Test Hits@20: 0.0015 | Best Val: 0.0014 (epoch 15) | LR: 0.010000 üî•
2025-12-08 01:04:04,616 - GCN-DiagTest FINAL: Best Val Hits@20 = 0.0014 | Test Hits@20 = 0.0015 (at epoch 15)
2025-12-08 01:04:04,616 - 
================================================================================
2025-12-08 01:04:04,616 - DIAGNOSTIC TEST COMPLETE
2025-12-08 01:04:04,616 - ================================================================================
2025-12-08 01:04:04,616 - Final Val Hits@20: 0.0014
2025-12-08 01:04:04,616 - Final Test Hits@20: 0.0015
2025-12-08 01:04:04,616 - Results logged to: logs/diagnostic_test_20251208_010337.log
2025-12-08 01:04:04,616 - 
Please review the diagnostic warnings above to identify any issues.
