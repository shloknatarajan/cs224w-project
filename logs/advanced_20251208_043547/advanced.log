2025-12-08 04:35:47,220 - Using device: cuda
2025-12-08 04:35:47,220 - Logging results to: logs/advanced_20251208_043547/advanced.log
2025-12-08 04:35:47,220 - Loading dataset ogbl-ddi...
2025-12-08 04:35:47,309 - Dataset loaded: 4267 nodes
2025-12-08 04:35:47,452 - Train pos edges: 1067911, Valid pos: 133489, Test pos: 133489
2025-12-08 04:35:47,452 - Valid neg edges: 101882, Test neg: 95599
2025-12-08 04:35:47,473 - Added self-loops: Total edges now = 1072178
2025-12-08 04:35:47,481 - Computing structural features (this may take a moment)...
2025-12-08 04:39:53,843 - Computed structural features (6 dims):
2025-12-08 04:39:53,845 -   - Degree: mean=4.473, std=1.892
2025-12-08 04:39:53,845 -   - Clustering: mean=0.514, std=0.219
2025-12-08 04:39:53,846 -   - Core number: mean=5.122, std=1.539
2025-12-08 04:39:53,846 -   - PageRank: mean=0.105, std=0.075
2025-12-08 04:39:53,846 - ================================================================================
2025-12-08 04:39:53,846 - MODEL CONFIGURATION - GCN-Structural-V3
2025-12-08 04:39:53,846 - ================================================================================
2025-12-08 04:39:53,846 - Architecture:
2025-12-08 04:39:53,846 -   Model: GCN-Structural-V3
2025-12-08 04:39:53,846 -   Hidden Dim: 256, Layers: 3
2025-12-08 04:39:53,846 -   Dropout: 0.2, Decoder Dropout: 0.3
2025-12-08 04:39:53,846 -   Structural Features: 6 dims
2025-12-08 04:39:53,847 -   Multi-strategy decoder: False
2025-12-08 04:39:53,847 -   Diversity Loss Weight: 0.05
2025-12-08 04:39:53,847 - 
2025-12-08 04:39:53,847 - Training:
2025-12-08 04:39:53,847 -   Epochs: 400, Patience: 20
2025-12-08 04:39:53,847 -   Learning Rate: 0.005, Weight Decay: 5e-05
2025-12-08 04:39:53,847 -   Hard Negatives: True (ratio=0.05)
2025-12-08 04:39:53,847 -   Batch Size: 20000, Eval Batch: 50000
2025-12-08 04:39:53,847 -   Gradient Accumulation Steps: 3
2025-12-08 04:39:53,847 - 
2025-12-08 04:39:53,847 - Dataset:
2025-12-08 04:39:53,847 -   Nodes: 4267
2025-12-08 04:39:53,847 -   Train Edges: 1067911
2025-12-08 04:39:53,847 -   Val Edges: 133489, Test Edges: 133489
2025-12-08 04:39:53,847 - ================================================================================
2025-12-08 04:39:53,847 - 
================================================================================
2025-12-08 04:39:53,847 - Training Advanced GCN with Structural Features
2025-12-08 04:39:53,847 - ================================================================================
2025-12-08 04:39:53,893 - Starting training for GCN-Structural-V3 (epochs=400, lr=0.005, patience=20, hard_neg=True)
2025-12-08 04:39:53,893 - Negative sampling: strategy=hard, ratio=0.05, k_hop=N/A
2025-12-08 04:39:53,893 - Model description: GCN-V3 with 6 structural features, layer norm, LeakyReLU, full residuals, strong diversity loss | hidden_dim=256, num_layers=3, dropout=0.2, decoder_dropout=0.3, decoder=simple, diversity_weight=0.05
2025-12-08 04:39:53,893 - Memory optimization: batch_size=20000, gradient_accumulation=3
2025-12-08 04:39:53,896 - Initialized EMA with decay=0.999 for stable checkpointing
2025-12-08 04:39:57,011 - GCN-Structural-V3 Epoch 0001/400 [Random Neg] | Loss: 1.7136 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:39:57,529 - [DIAGNOSTICS Epoch 1] Emb: sim_mean=0.994 sim_std=0.018 norm=15.259 | Scores: pos=0.019 neg=0.020 gap=-0.001 | Grad: norm=6.42
2025-12-08 04:39:57,529 -   ⚠️  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 04:39:57,529 -   ⚠️  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 04:39:57,529 -   ⚠️  DECODER BUG (pos_scores <= neg_scores)
2025-12-08 04:40:08,546 - GCN-Structural-V3 Epoch 0005/400 [Random Neg] | Loss: 1.5102 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:40:09,078 - [DIAGNOSTICS Epoch 5] Emb: sim_mean=0.997 sim_std=0.006 norm=14.460 | Scores: pos=0.532 neg=0.531 gap=0.000 | Grad: norm=0.51
2025-12-08 04:40:09,078 -   ⚠️  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 04:40:09,078 -   ⚠️  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 04:40:22,925 - GCN-Structural-V3 Epoch 0010/400 [Random Neg] | Loss: 1.4760 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:40:23,451 - [DIAGNOSTICS Epoch 10] Emb: sim_mean=0.998 sim_std=0.004 norm=15.165 | Scores: pos=0.497 neg=0.496 gap=0.001 | Grad: norm=0.06
2025-12-08 04:40:23,451 -   ⚠️  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 04:40:23,451 -   ⚠️  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 04:40:37,337 - GCN-Structural-V3 Epoch 0015/400 [Random Neg] | Loss: 1.4539 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:40:51,394 - GCN-Structural-V3 Epoch 0020/400 [Random Neg] | Loss: 1.3799 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:40:51,945 - [DIAGNOSTICS Epoch 20] Emb: sim_mean=0.988 sim_std=0.018 norm=15.421 | Scores: pos=0.548 neg=0.457 gap=0.091 | Grad: norm=0.40
2025-12-08 04:40:51,945 -   ⚠️  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 04:40:51,945 -   ⚠️  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 04:41:05,839 - GCN-Structural-V3 Epoch 0025/400 [Random Neg] | Loss: 1.3169 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:41:20,076 - GCN-Structural-V3 Epoch 0030/400 [Random Neg] | Loss: 1.2538 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:41:34,034 - GCN-Structural-V3 Epoch 0035/400 [Random Neg] | Loss: 1.2338 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:41:47,690 - GCN-Structural-V3 Epoch 0040/400 [Random Neg] | Loss: 1.1827 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:42:01,670 - GCN-Structural-V3 Epoch 0045/400 [Random Neg] | Loss: 1.1595 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:42:15,803 - GCN-Structural-V3 Epoch 0050/400 [Random Neg] | Loss: 1.1205 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:42:16,275 - [DIAGNOSTICS Epoch 50] Emb: sim_mean=0.848 sim_std=0.215 norm=14.311 | Scores: pos=0.668 neg=0.376 gap=0.292 | Grad: norm=0.65
2025-12-08 04:42:36,809 - GCN-Structural-V3 Epoch 0055/400 [Hard Neg] | Loss: 1.0980 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:42:37,300 - [DIAGNOSTICS Epoch 55] Emb: sim_mean=0.795 sim_std=0.216 norm=13.978 | Scores: pos=0.670 neg=0.342 gap=0.328 | Grad: norm=0.57
2025-12-08 04:42:58,120 - GCN-Structural-V3 Epoch 0060/400 [Hard Neg] | Loss: 1.0293 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:42:58,611 - [DIAGNOSTICS Epoch 60] Emb: sim_mean=0.786 sim_std=0.208 norm=13.984 | Scores: pos=0.696 neg=0.295 gap=0.401 | Grad: norm=0.28
2025-12-08 04:43:19,371 - GCN-Structural-V3 Epoch 0065/400 [Hard Neg] | Loss: 0.9903 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:43:19,869 - [DIAGNOSTICS Epoch 65] Emb: sim_mean=0.778 sim_std=0.192 norm=13.636 | Scores: pos=0.565 neg=0.180 gap=0.386 | Grad: norm=0.18
2025-12-08 04:43:40,827 - GCN-Structural-V3 Epoch 0070/400 [Hard Neg] | Loss: 1.0800 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:43:41,318 - [DIAGNOSTICS Epoch 70] Emb: sim_mean=0.816 sim_std=0.197 norm=13.224 | Scores: pos=0.525 neg=0.226 gap=0.299 | Grad: norm=0.77
2025-12-08 04:44:02,286 - GCN-Structural-V3 Epoch 0075/400 [Hard Neg] | Loss: 1.0813 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:44:02,761 - [DIAGNOSTICS Epoch 75] Emb: sim_mean=0.762 sim_std=0.235 norm=13.128 | Scores: pos=0.672 neg=0.320 gap=0.352 | Grad: norm=0.44
2025-12-08 04:44:23,292 - GCN-Structural-V3 Epoch 0080/400 [Hard Neg] | Loss: 1.0205 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.002500 
2025-12-08 04:44:23,775 - [DIAGNOSTICS Epoch 80] Emb: sim_mean=0.739 sim_std=0.223 norm=13.029 | Scores: pos=0.675 neg=0.275 gap=0.400 | Grad: norm=0.40
2025-12-08 04:44:44,006 - GCN-Structural-V3 Epoch 0085/400 [Hard Neg] | Loss: 0.9895 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.002500 
2025-12-08 04:44:44,519 - [DIAGNOSTICS Epoch 85] Emb: sim_mean=0.761 sim_std=0.210 norm=12.987 | Scores: pos=0.696 neg=0.260 gap=0.436 | Grad: norm=0.20
2025-12-08 04:45:04,792 - GCN-Structural-V3 Epoch 0090/400 [Hard Neg] | Loss: 0.9602 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.002500 
2025-12-08 04:45:05,265 - [DIAGNOSTICS Epoch 90] Emb: sim_mean=0.755 sim_std=0.206 norm=12.798 | Scores: pos=0.722 neg=0.281 gap=0.441 | Grad: norm=0.16
2025-12-08 04:45:25,804 - GCN-Structural-V3 Epoch 0095/400 [Hard Neg] | Loss: 0.9437 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.002500 
2025-12-08 04:45:26,266 - [DIAGNOSTICS Epoch 95] Emb: sim_mean=0.741 sim_std=0.205 norm=12.684 | Scores: pos=0.722 neg=0.260 gap=0.462 | Grad: norm=0.20
2025-12-08 04:45:26,274 - GCN-Structural-V3: Early stopping at epoch 95 (no improvement for 20 eval steps)
2025-12-08 04:45:26,274 - GCN-Structural-V3 FINAL: Best Val Hits@20 = 0.0000 | Test Hits@20 = 0.0000 (at epoch 0)
2025-12-08 04:45:26,275 - 
================================================================================
2025-12-08 04:45:26,275 - FINAL RESULTS
2025-12-08 04:45:26,275 - ================================================================================
2025-12-08 04:45:26,275 - Model: GCN-Structural-V3
2025-12-08 04:45:26,275 - Configuration: Hidden Dim=256, Layers=3, Dropout=0.2
2025-12-08 04:45:26,275 - 
2025-12-08 04:45:26,275 - GCN-Structural-V3:
2025-12-08 04:45:26,275 -   Validation Hits@20: 0.0000
2025-12-08 04:45:26,275 -   Test Hits@20: 0.0000
