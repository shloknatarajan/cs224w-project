2025-12-08 04:55:26,185 - Using device: cuda
2025-12-08 04:55:26,186 - Logging results to: logs/advanced_20251208_045526/advanced.log
2025-12-08 04:55:26,186 - Loading dataset ogbl-ddi...
2025-12-08 04:55:26,283 - Dataset loaded: 4267 nodes
2025-12-08 04:55:26,424 - Train pos edges: 1067911, Valid pos: 133489, Test pos: 133489
2025-12-08 04:55:26,424 - Valid neg edges: 101882, Test neg: 95599
2025-12-08 04:55:26,445 - Added self-loops: Total edges now = 1072178
2025-12-08 04:55:26,452 - Computing structural features (this may take a moment)...
2025-12-08 04:59:40,530 - Computed structural features (6 dims):
2025-12-08 04:59:40,532 -   - Degree: mean=4.473, std=1.892
2025-12-08 04:59:40,532 -   - Clustering: mean=0.514, std=0.219
2025-12-08 04:59:40,533 -   - Core number: mean=5.122, std=1.539
2025-12-08 04:59:40,533 -   - PageRank: mean=0.105, std=0.075
2025-12-08 04:59:40,533 - ================================================================================
2025-12-08 04:59:40,533 - MODEL CONFIGURATION - GCN-Structural-V4
2025-12-08 04:59:40,533 - ================================================================================
2025-12-08 04:59:40,533 - Architecture:
2025-12-08 04:59:40,533 -   Model: GCN-Structural-V4
2025-12-08 04:59:40,533 -   Hidden Dim: 256, Layers: 3
2025-12-08 04:59:40,533 -   Dropout: 0.2, Decoder Dropout: 0.3
2025-12-08 04:59:40,534 -   Structural Features: 6 dims
2025-12-08 04:59:40,534 -   Multi-strategy decoder: True
2025-12-08 04:59:40,534 -   Diversity Loss Weight: 0.02
2025-12-08 04:59:40,534 - 
2025-12-08 04:59:40,534 - Training:
2025-12-08 04:59:40,534 -   Epochs: 400, Patience: 20
2025-12-08 04:59:40,534 -   Learning Rate: 0.005, Weight Decay: 5e-05
2025-12-08 04:59:40,534 -   Hard Negatives: True (ratio=0.05)
2025-12-08 04:59:40,534 -   Batch Size: 20000, Eval Batch: 50000
2025-12-08 04:59:40,534 -   Gradient Accumulation Steps: 3
2025-12-08 04:59:40,534 - 
2025-12-08 04:59:40,534 - Dataset:
2025-12-08 04:59:40,534 -   Nodes: 4267
2025-12-08 04:59:40,534 -   Train Edges: 1067911
2025-12-08 04:59:40,534 -   Val Edges: 133489, Test Edges: 133489
2025-12-08 04:59:40,534 - ================================================================================
2025-12-08 04:59:40,535 - 
================================================================================
2025-12-08 04:59:40,535 - Training Advanced GCN with Structural Features
2025-12-08 04:59:40,535 - ================================================================================
2025-12-08 04:59:40,583 - Starting training for GCN-Structural-V4 (epochs=400, lr=0.005, patience=20, hard_neg=True)
2025-12-08 04:59:40,583 - Negative sampling: strategy=hard, ratio=0.05, k_hop=N/A
2025-12-08 04:59:40,583 - Model description: GCN-V4 with 6 structural features, multi-strategy decoder, layer norm, LeakyReLU, full residuals | hidden_dim=256, num_layers=3, dropout=0.2, decoder_dropout=0.3, decoder=multi-strategy, diversity_weight=0.02
2025-12-08 04:59:40,583 - Memory optimization: batch_size=20000, gradient_accumulation=3
2025-12-08 04:59:40,587 - Initialized EMA with decay=0.999 for stable checkpointing
2025-12-08 04:59:47,005 - GCN-Structural-V4 Epoch 0001/400 [Random Neg] | Loss: 3.1659 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 04:59:47,519 - [DIAGNOSTICS Epoch 1] Emb: sim_mean=0.997 sim_std=0.010 norm=15.683 | Scores: pos=0.000 neg=0.000 gap=-0.000 | Grad: norm=68.46
2025-12-08 04:59:47,520 -   ⚠️  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 04:59:47,520 -   ⚠️  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 04:59:47,520 -   ⚠️  DECODER BUG (pos_scores <= neg_scores)
2025-12-08 05:00:11,501 - GCN-Structural-V4 Epoch 0005/400 [Random Neg] | Loss: 2.3563 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:00:12,004 - [DIAGNOSTICS Epoch 5] Emb: sim_mean=0.998 sim_std=0.006 norm=14.341 | Scores: pos=0.000 neg=0.000 gap=0.000 | Grad: norm=10.54
2025-12-08 05:00:12,004 -   ⚠️  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 05:00:12,004 -   ⚠️  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 05:00:41,925 - GCN-Structural-V4 Epoch 0010/400 [Random Neg] | Loss: 4.9664 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:00:42,415 - [DIAGNOSTICS Epoch 10] Emb: sim_mean=0.994 sim_std=0.011 norm=12.970 | Scores: pos=0.998 neg=0.987 gap=0.011 | Grad: norm=57.52
2025-12-08 05:00:42,416 -   ⚠️  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 05:00:42,416 -   ⚠️  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 05:01:12,469 - GCN-Structural-V4 Epoch 0015/400 [Random Neg] | Loss: 4.0383 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:01:41,824 - GCN-Structural-V4 Epoch 0020/400 [Random Neg] | Loss: 1.2271 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:01:42,265 - [DIAGNOSTICS Epoch 20] Emb: sim_mean=0.978 sim_std=0.030 norm=10.974 | Scores: pos=0.180 neg=0.037 gap=0.143 | Grad: norm=9.95
2025-12-08 05:01:42,265 -   ⚠️  EMBEDDING COLLAPSE (similarity > 0.9)
2025-12-08 05:01:42,265 -   ⚠️  LOW EMBEDDING DIVERSITY (std < 0.05)
2025-12-08 05:02:11,456 - GCN-Structural-V4 Epoch 0025/400 [Random Neg] | Loss: 1.3858 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:02:41,030 - GCN-Structural-V4 Epoch 0030/400 [Random Neg] | Loss: 1.5716 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:03:10,795 - GCN-Structural-V4 Epoch 0035/400 [Random Neg] | Loss: 1.4910 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:03:38,931 - GCN-Structural-V4 Epoch 0040/400 [Random Neg] | Loss: 1.1119 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:04:04,649 - GCN-Structural-V4 Epoch 0045/400 [Random Neg] | Loss: 0.8872 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:04:30,319 - GCN-Structural-V4 Epoch 0050/400 [Random Neg] | Loss: 0.8198 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:04:30,688 - [DIAGNOSTICS Epoch 50] Emb: sim_mean=0.863 sim_std=0.136 norm=8.215 | Scores: pos=0.822 neg=0.242 gap=0.580 | Grad: norm=1.04
2025-12-08 05:05:02,030 - GCN-Structural-V4 Epoch 0055/400 [Hard Neg] | Loss: 0.7989 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:05:02,406 - [DIAGNOSTICS Epoch 55] Emb: sim_mean=0.877 sim_std=0.104 norm=8.040 | Scores: pos=0.752 neg=0.172 gap=0.580 | Grad: norm=1.19
2025-12-08 05:05:33,587 - GCN-Structural-V4 Epoch 0060/400 [Hard Neg] | Loss: 0.7504 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:05:33,966 - [DIAGNOSTICS Epoch 60] Emb: sim_mean=0.830 sim_std=0.124 norm=8.155 | Scores: pos=0.839 neg=0.224 gap=0.615 | Grad: norm=1.23
2025-12-08 05:06:05,176 - GCN-Structural-V4 Epoch 0065/400 [Hard Neg] | Loss: 0.7463 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:06:05,557 - [DIAGNOSTICS Epoch 65] Emb: sim_mean=0.846 sim_std=0.116 norm=8.136 | Scores: pos=0.856 neg=0.210 gap=0.646 | Grad: norm=2.65
2025-12-08 05:06:36,737 - GCN-Structural-V4 Epoch 0070/400 [Hard Neg] | Loss: 0.6843 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:06:37,118 - [DIAGNOSTICS Epoch 70] Emb: sim_mean=0.827 sim_std=0.135 norm=8.135 | Scores: pos=0.791 neg=0.149 gap=0.642 | Grad: norm=0.78
2025-12-08 05:07:08,294 - GCN-Structural-V4 Epoch 0075/400 [Hard Neg] | Loss: 0.6790 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.005000 
2025-12-08 05:07:08,662 - [DIAGNOSTICS Epoch 75] Emb: sim_mean=0.806 sim_std=0.151 norm=8.236 | Scores: pos=0.871 neg=0.198 gap=0.673 | Grad: norm=0.91
2025-12-08 05:07:39,453 - GCN-Structural-V4 Epoch 0080/400 [Hard Neg] | Loss: 0.6426 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.002500 
2025-12-08 05:07:39,820 - [DIAGNOSTICS Epoch 80] Emb: sim_mean=0.798 sim_std=0.152 norm=8.047 | Scores: pos=0.774 neg=0.123 gap=0.651 | Grad: norm=0.46
2025-12-08 05:08:10,458 - GCN-Structural-V4 Epoch 0085/400 [Hard Neg] | Loss: 0.6368 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.002500 
2025-12-08 05:08:10,825 - [DIAGNOSTICS Epoch 85] Emb: sim_mean=0.788 sim_std=0.158 norm=8.096 | Scores: pos=0.781 neg=0.141 gap=0.641 | Grad: norm=0.65
2025-12-08 05:08:41,593 - GCN-Structural-V4 Epoch 0090/400 [Hard Neg] | Loss: 0.6399 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.002500 
2025-12-08 05:08:41,958 - [DIAGNOSTICS Epoch 90] Emb: sim_mean=0.768 sim_std=0.170 norm=8.129 | Scores: pos=0.820 neg=0.163 gap=0.658 | Grad: norm=1.02
2025-12-08 05:09:12,567 - GCN-Structural-V4 Epoch 0095/400 [Hard Neg] | Loss: 0.6330 | Val Hits@20: 0.0000 | Test Hits@20: 0.0000 | Best Val: 0.0000 (epoch 0) | LR: 0.002500 
2025-12-08 05:09:12,933 - [DIAGNOSTICS Epoch 95] Emb: sim_mean=0.758 sim_std=0.175 norm=8.103 | Scores: pos=0.839 neg=0.137 gap=0.701 | Grad: norm=0.82
2025-12-08 05:09:12,938 - GCN-Structural-V4: Early stopping at epoch 95 (no improvement for 20 eval steps)
2025-12-08 05:09:12,939 - GCN-Structural-V4 FINAL: Best Val Hits@20 = 0.0000 | Test Hits@20 = 0.0000 (at epoch 0)
2025-12-08 05:09:12,939 - 
================================================================================
2025-12-08 05:09:12,939 - FINAL RESULTS
2025-12-08 05:09:12,939 - ================================================================================
2025-12-08 05:09:12,939 - Model: GCN-Structural-V4
2025-12-08 05:09:12,939 - Configuration: Hidden Dim=256, Layers=3, Dropout=0.2
2025-12-08 05:09:12,939 - 
2025-12-08 05:09:12,939 - GCN-Structural-V4:
2025-12-08 05:09:12,939 -   Validation Hits@20: 0.0000
2025-12-08 05:09:12,939 -   Test Hits@20: 0.0000
