2025-12-09 23:10:44,935 - Using device: cuda
2025-12-09 23:10:44,935 - Logging results to: logs/hybrid_20251209_231044/hybrid.log
2025-12-09 23:10:44,935 - Loading dataset with ChemBERTa embeddings + SMILES mask...
2025-12-09 23:10:44,935 - Loading dataset ogbl-ddi...
2025-12-09 23:10:45,020 - Dataset loaded: 4267 nodes
2025-12-09 23:10:45,182 - Train pos edges: 1067911, Valid pos: 133489, Test pos: 133489
2025-12-09 23:10:45,183 - Valid neg edges: 101882, Test neg: 95599
2025-12-09 23:10:45,196 - Computing structural features (this may take a moment)...
2025-12-09 23:14:44,550 - Computed structural features (6 dims):
2025-12-09 23:14:44,553 -   - Degree: mean=4.473, std=1.892
2025-12-09 23:14:44,553 -   - Clustering: mean=0.514, std=0.219
2025-12-09 23:14:44,553 -   - Core number: mean=5.122, std=1.539
2025-12-09 23:14:44,553 -   - PageRank: mean=0.105, std=0.075
2025-12-09 23:14:44,555 - Added self-loops: Total edges now = 1072178
2025-12-09 23:14:44,555 - Loading cached ChemBERTa features from data/chemberta_features_768.pt
2025-12-09 23:14:44,565 - Loading cached SMILES mask from data/chemberta_features_768_mask.pt
2025-12-09 23:14:44,565 - Attached ChemBERTa features: data.x shape = torch.Size([4267, 768])
2025-12-09 23:14:44,568 - Attached SMILES mask: 2287 valid / 4267 total (53.6%)
2025-12-09 23:14:44,568 - Attached structural features: data.struct_features shape = torch.Size([4267, 6])
2025-12-09 23:14:44,573 - Dataset loaded with ChemBERTa features: data.x.shape = torch.Size([4267, 768])
2025-12-09 23:14:44,574 - SMILES mask: 2287 valid / 4267 total (53.6%)
2025-12-09 23:14:44,574 - 
================================================================================
2025-12-09 23:14:44,574 - Training Hybrid-GCN-ChemAware
2025-12-09 23:14:44,574 - ================================================================================
2025-12-09 23:14:44,611 - Model: Hybrid-GCN (2 layers, dropout=0.0) | Structure-only encoder + chemistry_aware decoder | hidden=128, chem_dim=768
2025-12-09 23:14:44,614 - [Hybrid-GCN-ChemAware] Starting hybrid model training (epochs=200, lr=0.01, wd=0.0001, batch_size=5000, eval_every=5)
2025-12-09 23:15:09,920 - [Hybrid-GCN-ChemAware] Epoch 0001 | loss 1.4156 | val@20 0.0023 | test@20 0.0030 | best 0.0023 (ep 1)
2025-12-09 23:15:48,517 - [Hybrid-GCN-ChemAware] Epoch 0005 | loss 3.2404 | val@20 0.0062 | test@20 0.0028 | best 0.0062 (ep 5)
2025-12-09 23:16:31,937 - [Hybrid-GCN-ChemAware] Epoch 0010 | loss 1.5983 | val@20 0.0412 | test@20 0.0176 | best 0.0412 (ep 10)
2025-12-09 23:17:14,855 - [Hybrid-GCN-ChemAware] Epoch 0015 | loss 1.4974 | val@20 0.0416 | test@20 0.0114 | best 0.0416 (ep 15)
2025-12-09 23:17:58,180 - [Hybrid-GCN-ChemAware] Epoch 0020 | loss 1.2673 | val@20 0.0516 | test@20 0.0274 | best 0.0516 (ep 20)
2025-12-09 23:18:41,413 - [Hybrid-GCN-ChemAware] Epoch 0025 | loss 1.1154 | val@20 0.0938 | test@20 0.0337 | best 0.0938 (ep 25)
2025-12-09 23:19:24,388 - [Hybrid-GCN-ChemAware] Epoch 0030 | loss 1.0102 | val@20 0.0335 | test@20 0.0114 | best 0.0938 (ep 25)
2025-12-09 23:20:07,534 - [Hybrid-GCN-ChemAware] Epoch 0035 | loss 0.9265 | val@20 0.0508 | test@20 0.0076 | best 0.0938 (ep 25)
2025-12-09 23:20:50,989 - [Hybrid-GCN-ChemAware] Epoch 0040 | loss 0.8484 | val@20 0.1177 | test@20 0.0362 | best 0.1177 (ep 40)
2025-12-09 23:21:34,339 - [Hybrid-GCN-ChemAware] Epoch 0045 | loss 0.9478 | val@20 0.1430 | test@20 0.1140 | best 0.1430 (ep 45)
2025-12-09 23:22:17,366 - [Hybrid-GCN-ChemAware] Epoch 0050 | loss 0.9319 | val@20 0.0572 | test@20 0.0138 | best 0.1430 (ep 45)
2025-12-09 23:23:00,269 - [Hybrid-GCN-ChemAware] Epoch 0055 | loss 0.8764 | val@20 0.1470 | test@20 0.1038 | best 0.1470 (ep 55)
2025-12-09 23:23:43,123 - [Hybrid-GCN-ChemAware] Epoch 0060 | loss 0.8331 | val@20 0.1265 | test@20 0.1054 | best 0.1470 (ep 55)
2025-12-09 23:24:26,193 - [Hybrid-GCN-ChemAware] Epoch 0065 | loss 0.7970 | val@20 0.1145 | test@20 0.0508 | best 0.1470 (ep 55)
2025-12-09 23:25:09,540 - [Hybrid-GCN-ChemAware] Epoch 0070 | loss 0.7744 | val@20 0.0868 | test@20 0.0284 | best 0.1470 (ep 55)
2025-12-09 23:25:52,839 - [Hybrid-GCN-ChemAware] Epoch 0075 | loss 0.7547 | val@20 0.0945 | test@20 0.0455 | best 0.1470 (ep 55)
2025-12-09 23:26:35,707 - [Hybrid-GCN-ChemAware] Epoch 0080 | loss 0.7404 | val@20 0.0832 | test@20 0.0571 | best 0.1470 (ep 55)
2025-12-09 23:27:19,015 - [Hybrid-GCN-ChemAware] Epoch 0085 | loss 0.7252 | val@20 0.1460 | test@20 0.0911 | best 0.1470 (ep 55)
2025-12-09 23:28:02,491 - [Hybrid-GCN-ChemAware] Epoch 0090 | loss 0.7102 | val@20 0.1339 | test@20 0.1080 | best 0.1470 (ep 55)
2025-12-09 23:28:45,906 - [Hybrid-GCN-ChemAware] Epoch 0095 | loss 0.7000 | val@20 0.1422 | test@20 0.1750 | best 0.1470 (ep 55)
2025-12-09 23:29:29,129 - [Hybrid-GCN-ChemAware] Epoch 0100 | loss 0.6878 | val@20 0.1438 | test@20 0.1594 | best 0.1470 (ep 55)
2025-12-09 23:30:11,955 - [Hybrid-GCN-ChemAware] Epoch 0105 | loss 0.6803 | val@20 0.1213 | test@20 0.1559 | best 0.1470 (ep 55)
2025-12-09 23:30:55,309 - [Hybrid-GCN-ChemAware] Epoch 0110 | loss 0.6749 | val@20 0.1245 | test@20 0.1646 | best 0.1470 (ep 55)
2025-12-09 23:31:38,490 - [Hybrid-GCN-ChemAware] Epoch 0115 | loss 0.6663 | val@20 0.0991 | test@20 0.1531 | best 0.1470 (ep 55)
2025-12-09 23:32:21,985 - [Hybrid-GCN-ChemAware] Epoch 0120 | loss 0.6796 | val@20 0.0842 | test@20 0.1601 | best 0.1470 (ep 55)
2025-12-09 23:33:04,907 - [Hybrid-GCN-ChemAware] Epoch 0125 | loss 0.7289 | val@20 0.1614 | test@20 0.2107 | best 0.1614 (ep 125)
2025-12-09 23:33:48,234 - [Hybrid-GCN-ChemAware] Epoch 0130 | loss 0.7013 | val@20 0.1725 | test@20 0.2187 | best 0.1725 (ep 130)
2025-12-09 23:34:31,566 - [Hybrid-GCN-ChemAware] Epoch 0135 | loss 0.6809 | val@20 0.1627 | test@20 0.1700 | best 0.1725 (ep 130)
2025-12-09 23:35:14,896 - [Hybrid-GCN-ChemAware] Epoch 0140 | loss 0.6593 | val@20 0.0965 | test@20 0.1543 | best 0.1725 (ep 130)
2025-12-09 23:35:58,249 - [Hybrid-GCN-ChemAware] Epoch 0145 | loss 0.6519 | val@20 0.1096 | test@20 0.1542 | best 0.1725 (ep 130)
2025-12-09 23:36:41,225 - [Hybrid-GCN-ChemAware] Epoch 0150 | loss 0.6416 | val@20 0.1128 | test@20 0.1273 | best 0.1725 (ep 130)
2025-12-09 23:37:24,107 - [Hybrid-GCN-ChemAware] Epoch 0155 | loss 0.6355 | val@20 0.0959 | test@20 0.1330 | best 0.1725 (ep 130)
2025-12-09 23:38:07,426 - [Hybrid-GCN-ChemAware] Epoch 0160 | loss 0.6281 | val@20 0.1099 | test@20 0.1299 | best 0.1725 (ep 130)
2025-12-09 23:38:50,901 - [Hybrid-GCN-ChemAware] Epoch 0165 | loss 0.6219 | val@20 0.1194 | test@20 0.1650 | best 0.1725 (ep 130)
2025-12-09 23:39:34,213 - [Hybrid-GCN-ChemAware] Epoch 0170 | loss 0.6171 | val@20 0.1351 | test@20 0.1566 | best 0.1725 (ep 130)
2025-12-09 23:40:17,163 - [Hybrid-GCN-ChemAware] Epoch 0175 | loss 0.6243 | val@20 0.1281 | test@20 0.1394 | best 0.1725 (ep 130)
2025-12-09 23:41:00,148 - [Hybrid-GCN-ChemAware] Epoch 0180 | loss 0.6090 | val@20 0.1558 | test@20 0.1628 | best 0.1725 (ep 130)
2025-12-09 23:41:43,465 - [Hybrid-GCN-ChemAware] Epoch 0185 | loss 0.6079 | val@20 0.1420 | test@20 0.1868 | best 0.1725 (ep 130)
2025-12-09 23:42:26,758 - [Hybrid-GCN-ChemAware] Epoch 0190 | loss 0.6057 | val@20 0.1601 | test@20 0.1486 | best 0.1725 (ep 130)
2025-12-09 23:43:10,059 - [Hybrid-GCN-ChemAware] Epoch 0195 | loss 0.6004 | val@20 0.1544 | test@20 0.1537 | best 0.1725 (ep 130)
2025-12-09 23:43:52,938 - [Hybrid-GCN-ChemAware] Epoch 0200 | loss 0.6018 | val@20 0.1882 | test@20 0.1557 | best 0.1882 (ep 200)
2025-12-09 23:43:52,938 - [Hybrid-GCN-ChemAware] Done. Best val@20=0.1882 | test@20=0.1557 (epoch 200)
2025-12-09 23:43:52,938 - [Hybrid-GCN-ChemAware] Done. Best val@20=0.1882 | test@20=0.1557
2025-12-09 23:43:52,938 - 
================================================================================
2025-12-09 23:43:52,938 - Training Hybrid-GCN-Simple
2025-12-09 23:43:52,939 - ================================================================================
2025-12-09 23:43:52,945 - Model: Hybrid-GCN (2 layers, dropout=0.0) | Structure-only encoder + simple decoder | hidden=128, chem_dim=768
2025-12-09 23:43:52,948 - [Hybrid-GCN-Simple] Starting hybrid model training (epochs=200, lr=0.01, wd=0.0001, batch_size=5000, eval_every=5)
2025-12-09 23:44:17,714 - [Hybrid-GCN-Simple] Epoch 0001 | loss 1.3912 | val@20 0.0020 | test@20 0.0019 | best 0.0020 (ep 1)
2025-12-09 23:44:55,251 - [Hybrid-GCN-Simple] Epoch 0005 | loss 1.3691 | val@20 0.0269 | test@20 0.0038 | best 0.0269 (ep 5)
2025-12-09 23:45:36,946 - [Hybrid-GCN-Simple] Epoch 0010 | loss 1.2330 | val@20 0.0041 | test@20 0.0053 | best 0.0269 (ep 5)
2025-12-09 23:46:18,722 - [Hybrid-GCN-Simple] Epoch 0015 | loss 1.1060 | val@20 0.0364 | test@20 0.0130 | best 0.0364 (ep 15)
2025-12-09 23:47:00,047 - [Hybrid-GCN-Simple] Epoch 0020 | loss 0.9914 | val@20 0.1501 | test@20 0.1101 | best 0.1501 (ep 20)
2025-12-09 23:47:41,740 - [Hybrid-GCN-Simple] Epoch 0025 | loss 0.9804 | val@20 0.1637 | test@20 0.1323 | best 0.1637 (ep 25)
2025-12-09 23:48:22,987 - [Hybrid-GCN-Simple] Epoch 0030 | loss 0.9007 | val@20 0.0906 | test@20 0.0471 | best 0.1637 (ep 25)
2025-12-09 23:49:04,280 - [Hybrid-GCN-Simple] Epoch 0035 | loss 0.8284 | val@20 0.1784 | test@20 0.1517 | best 0.1784 (ep 35)
2025-12-09 23:49:45,484 - [Hybrid-GCN-Simple] Epoch 0040 | loss 0.8021 | val@20 0.0729 | test@20 0.0586 | best 0.1784 (ep 35)
2025-12-09 23:50:26,825 - [Hybrid-GCN-Simple] Epoch 0045 | loss 0.7870 | val@20 0.1578 | test@20 0.1523 | best 0.1784 (ep 35)
2025-12-09 23:51:08,705 - [Hybrid-GCN-Simple] Epoch 0050 | loss 0.7694 | val@20 0.1405 | test@20 0.1278 | best 0.1784 (ep 35)
2025-12-09 23:51:50,457 - [Hybrid-GCN-Simple] Epoch 0055 | loss 0.7578 | val@20 0.0851 | test@20 0.0655 | best 0.1784 (ep 35)
2025-12-09 23:52:31,751 - [Hybrid-GCN-Simple] Epoch 0060 | loss 0.7409 | val@20 0.0094 | test@20 0.0027 | best 0.1784 (ep 35)
2025-12-09 23:53:13,027 - [Hybrid-GCN-Simple] Epoch 0065 | loss 0.7295 | val@20 0.1742 | test@20 0.1541 | best 0.1784 (ep 35)
2025-12-09 23:53:54,179 - [Hybrid-GCN-Simple] Epoch 0070 | loss 0.7535 | val@20 0.2349 | test@20 0.1933 | best 0.2349 (ep 70)
2025-12-09 23:54:35,964 - [Hybrid-GCN-Simple] Epoch 0075 | loss 0.7210 | val@20 0.1669 | test@20 0.1531 | best 0.2349 (ep 70)
2025-12-09 23:55:17,700 - [Hybrid-GCN-Simple] Epoch 0080 | loss 0.7061 | val@20 0.1056 | test@20 0.0650 | best 0.2349 (ep 70)
2025-12-09 23:55:59,440 - [Hybrid-GCN-Simple] Epoch 0085 | loss 0.6857 | val@20 0.1726 | test@20 0.1385 | best 0.2349 (ep 70)
2025-12-09 23:56:40,630 - [Hybrid-GCN-Simple] Epoch 0090 | loss 0.6743 | val@20 0.1077 | test@20 0.0984 | best 0.2349 (ep 70)
2025-12-09 23:57:22,408 - [Hybrid-GCN-Simple] Epoch 0095 | loss 0.6684 | val@20 0.1018 | test@20 0.0702 | best 0.2349 (ep 70)
2025-12-09 23:58:04,156 - [Hybrid-GCN-Simple] Epoch 0100 | loss 0.6577 | val@20 0.1326 | test@20 0.1247 | best 0.2349 (ep 70)
2025-12-09 23:58:45,895 - [Hybrid-GCN-Simple] Epoch 0105 | loss 0.6769 | val@20 0.0620 | test@20 0.0747 | best 0.2349 (ep 70)
2025-12-09 23:59:27,171 - [Hybrid-GCN-Simple] Epoch 0110 | loss 0.7285 | val@20 0.1692 | test@20 0.0528 | best 0.2349 (ep 70)
2025-12-10 00:00:08,461 - [Hybrid-GCN-Simple] Epoch 0115 | loss 0.6894 | val@20 0.1214 | test@20 0.0161 | best 0.2349 (ep 70)
2025-12-10 00:00:50,279 - [Hybrid-GCN-Simple] Epoch 0120 | loss 0.6483 | val@20 0.1048 | test@20 0.0557 | best 0.2349 (ep 70)
2025-12-10 00:01:32,023 - [Hybrid-GCN-Simple] Epoch 0125 | loss 0.6373 | val@20 0.0700 | test@20 0.0404 | best 0.2349 (ep 70)
2025-12-10 00:02:13,327 - [Hybrid-GCN-Simple] Epoch 0130 | loss 0.6316 | val@20 0.0651 | test@20 0.0385 | best 0.2349 (ep 70)
2025-12-10 00:02:55,031 - [Hybrid-GCN-Simple] Epoch 0135 | loss 0.6254 | val@20 0.1006 | test@20 0.1443 | best 0.2349 (ep 70)
2025-12-10 00:03:36,293 - [Hybrid-GCN-Simple] Epoch 0140 | loss 0.6186 | val@20 0.1357 | test@20 0.1737 | best 0.2349 (ep 70)
2025-12-10 00:04:17,550 - [Hybrid-GCN-Simple] Epoch 0145 | loss 0.6100 | val@20 0.1914 | test@20 0.2074 | best 0.2349 (ep 70)
2025-12-10 00:04:58,830 - [Hybrid-GCN-Simple] Epoch 0150 | loss 0.6109 | val@20 0.1850 | test@20 0.2192 | best 0.2349 (ep 70)
2025-12-10 00:05:40,267 - [Hybrid-GCN-Simple] Epoch 0155 | loss 0.6033 | val@20 0.1930 | test@20 0.2090 | best 0.2349 (ep 70)
2025-12-10 00:06:21,973 - [Hybrid-GCN-Simple] Epoch 0160 | loss 0.5980 | val@20 0.2297 | test@20 0.2285 | best 0.2349 (ep 70)
2025-12-10 00:07:03,645 - [Hybrid-GCN-Simple] Epoch 0165 | loss 0.5908 | val@20 0.1993 | test@20 0.2230 | best 0.2349 (ep 70)
2025-12-10 00:07:45,360 - [Hybrid-GCN-Simple] Epoch 0170 | loss 0.5964 | val@20 0.2017 | test@20 0.1909 | best 0.2349 (ep 70)
2025-12-10 00:07:45,361 - [Hybrid-GCN-Simple] Early stopping at epoch 170 (no val improvement for 20 evals)
2025-12-10 00:07:45,361 - [Hybrid-GCN-Simple] Done. Best val@20=0.2349 | test@20=0.1933 (epoch 70)
2025-12-10 00:07:45,361 - [Hybrid-GCN-Simple] Done. Best val@20=0.2349 | test@20=0.1933
2025-12-10 00:07:45,361 - 
================================================================================
2025-12-10 00:07:45,361 - Training Hybrid-GCN-ChemAware-Gated
2025-12-10 00:07:45,361 - ================================================================================
2025-12-10 00:07:45,369 - Model: Hybrid-GCN (2 layers, dropout=0.0) | Structure-only encoder + chemistry_aware+gate decoder | hidden=128, chem_dim=768
2025-12-10 00:07:45,372 - [Hybrid-GCN-ChemAware-Gated] Starting hybrid model training (epochs=200, lr=0.01, wd=0.0001, batch_size=5000, eval_every=5)
2025-12-10 00:08:10,641 - [Hybrid-GCN-ChemAware-Gated] Epoch 0001 | loss 1.3636 | val@20 0.0009 | test@20 0.0007 | best 0.0009 (ep 1)
2025-12-10 00:08:50,104 - [Hybrid-GCN-ChemAware-Gated] Epoch 0005 | loss 1.3290 | val@20 0.0055 | test@20 0.0031 | best 0.0055 (ep 5)
2025-12-10 00:09:34,539 - [Hybrid-GCN-ChemAware-Gated] Epoch 0010 | loss 1.1850 | val@20 0.0472 | test@20 0.0205 | best 0.0472 (ep 10)
2025-12-10 00:10:18,968 - [Hybrid-GCN-ChemAware-Gated] Epoch 0015 | loss 1.1015 | val@20 0.0409 | test@20 0.0149 | best 0.0472 (ep 10)
2025-12-10 00:11:03,337 - [Hybrid-GCN-ChemAware-Gated] Epoch 0020 | loss 1.0242 | val@20 0.0345 | test@20 0.0301 | best 0.0472 (ep 10)
2025-12-10 00:11:47,857 - [Hybrid-GCN-ChemAware-Gated] Epoch 0025 | loss 1.0730 | val@20 0.0677 | test@20 0.0510 | best 0.0677 (ep 25)
2025-12-10 00:12:31,862 - [Hybrid-GCN-ChemAware-Gated] Epoch 0030 | loss 0.9245 | val@20 0.0291 | test@20 0.0159 | best 0.0677 (ep 25)
2025-12-10 00:13:16,327 - [Hybrid-GCN-ChemAware-Gated] Epoch 0035 | loss 0.8779 | val@20 0.0255 | test@20 0.0094 | best 0.0677 (ep 25)
2025-12-10 00:14:00,834 - [Hybrid-GCN-ChemAware-Gated] Epoch 0040 | loss 0.8278 | val@20 0.1054 | test@20 0.1013 | best 0.1054 (ep 40)
2025-12-10 00:14:44,834 - [Hybrid-GCN-ChemAware-Gated] Epoch 0045 | loss 0.8069 | val@20 0.0319 | test@20 0.0101 | best 0.1054 (ep 40)
2025-12-10 00:15:29,349 - [Hybrid-GCN-ChemAware-Gated] Epoch 0050 | loss 0.7850 | val@20 0.1086 | test@20 0.0758 | best 0.1086 (ep 50)
2025-12-10 00:16:13,301 - [Hybrid-GCN-ChemAware-Gated] Epoch 0055 | loss 0.7640 | val@20 0.0696 | test@20 0.0570 | best 0.1086 (ep 50)
2025-12-10 00:16:57,852 - [Hybrid-GCN-ChemAware-Gated] Epoch 0060 | loss 0.7581 | val@20 0.0789 | test@20 0.0542 | best 0.1086 (ep 50)
2025-12-10 00:17:41,872 - [Hybrid-GCN-ChemAware-Gated] Epoch 0065 | loss 0.7415 | val@20 0.1790 | test@20 0.1344 | best 0.1790 (ep 65)
2025-12-10 00:18:26,386 - [Hybrid-GCN-ChemAware-Gated] Epoch 0070 | loss 0.7243 | val@20 0.1267 | test@20 0.0704 | best 0.1790 (ep 65)
2025-12-10 00:19:10,324 - [Hybrid-GCN-ChemAware-Gated] Epoch 0075 | loss 0.7182 | val@20 0.1602 | test@20 0.1573 | best 0.1790 (ep 65)
2025-12-10 00:19:54,778 - [Hybrid-GCN-ChemAware-Gated] Epoch 0080 | loss 0.7160 | val@20 0.1511 | test@20 0.1671 | best 0.1790 (ep 65)
2025-12-10 00:20:38,883 - [Hybrid-GCN-ChemAware-Gated] Epoch 0085 | loss 0.6945 | val@20 0.1859 | test@20 0.2160 | best 0.1859 (ep 85)
2025-12-10 00:21:22,841 - [Hybrid-GCN-ChemAware-Gated] Epoch 0090 | loss 0.6790 | val@20 0.1289 | test@20 0.1629 | best 0.1859 (ep 85)
2025-12-10 00:22:07,416 - [Hybrid-GCN-ChemAware-Gated] Epoch 0095 | loss 0.6750 | val@20 0.1207 | test@20 0.1697 | best 0.1859 (ep 85)
2025-12-10 00:22:51,330 - [Hybrid-GCN-ChemAware-Gated] Epoch 0100 | loss 0.6672 | val@20 0.1480 | test@20 0.1886 | best 0.1859 (ep 85)
2025-12-10 00:23:35,915 - [Hybrid-GCN-ChemAware-Gated] Epoch 0105 | loss 0.6573 | val@20 0.1732 | test@20 0.1984 | best 0.1859 (ep 85)
